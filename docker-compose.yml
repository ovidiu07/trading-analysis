version: '3.9'
services:
  backend:
    container_name: tradevault-service
    build: ./backend
    environment:
      DB_URL: jdbc:postgresql://tradevault-do-user-13395375-0.l.db.ondigitalocean.com:25060/tradevault?sslmode=require
      DB_USER: tradevault
      DB_PASS: ${DB_PASS:-}
      JWT_SECRET: ${JWT_SECRET:-}
      STORAGE_S3_ENABLED: ${STORAGE_S3_ENABLED:-true}
      STORAGE_S3_BUCKET: ${STORAGE_S3_BUCKET:-tradejaudit}
      STORAGE_S3_REGION: ${STORAGE_S3_REGION:-eu-central-1}
      AWS_REGION: ${AWS_REGION:-}
      STORAGE_S3_ENDPOINT: ${STORAGE_S3_ENDPOINT:-}
      STORAGE_S3_ACCESS_KEY: ${STORAGE_S3_ACCESS_KEY:-}
      STORAGE_S3_ACCESS_KEY_FILE: ${STORAGE_S3_ACCESS_KEY_FILE:-}
      AWS_ACCESS_KEY_ID: ${AWS_ACCESS_KEY_ID:-}
      AWS_ACCESS_KEY_ID_FILE: ${AWS_ACCESS_KEY_ID_FILE:-}
      STORAGE_S3_SECRET_KEY: ${STORAGE_S3_SECRET_KEY:-}
      STORAGE_S3_SECRET_KEY_FILE: ${STORAGE_S3_SECRET_KEY_FILE:-}
      AWS_SECRET_ACCESS_KEY: ${AWS_SECRET_ACCESS_KEY:-}
      AWS_SECRET_ACCESS_KEY_FILE: ${AWS_SECRET_ACCESS_KEY_FILE:-}
      STORAGE_S3_PATH_STYLE: false
      STORAGE_S3_PATH_STYLE_ACCESS: false
      STORAGE_S3_FORCE_PATH_STYLE: false
      STORAGE_S3_USE_IAM_ROLE: false
      STORAGE_S3_PROFILE_NAME:
      STORAGE_S3_PUBLIC_BASE_URL:
      STORAGE_S3_PRESIGN_ENABLED: false
      STORAGE_S3_PRESIGN_EXPIRATION_MINUTES: 60
      FRONTEND_URL: ${FRONTEND_URL:-https://tradejaudit.com}
    ports:
      - "8080:8080"
  frontend:
    build: ./frontend
    depends_on:
      - backend
    ports:
      - "4173:80"

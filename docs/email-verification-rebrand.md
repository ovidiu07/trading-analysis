# TradeJAudit Verification Email Rebrand

## What changed
- Registration/resend verification emails now use TradeJAudit branding and localized copy (`en`, `ro`).
- Sender defaults are now:
  - `From`: `TradeJAudit <no-reply@tradejaudit.com>`
  - `Reply-To`: `support@tradejaudit.com` (fallback: `contact@tradejaudit.com`)
- Verification template is rebuilt as table-based dark email HTML with:
  - hidden preheader
  - centered `max-width: 600px` container
  - card surface layout
  - brand header with hosted PNG logo + text fallback
  - Outlook-safe CTA button
  - raw verification URL fallback
  - expiry + security/help copy
  - legal footer with Terms/Privacy/Cookies links

## Backend mail config
Set these in environment/application config:

- `MAIL_FROM_NAME=TradeJAudit`
- `MAIL_FROM_ADDRESS=no-reply@tradejaudit.com`
- `MAIL_REPLY_TO_ADDRESS=support@tradejaudit.com`
- `MAIL_SUPPORT_EMAIL=support@tradejaudit.com`
- `MAIL_CONTACT_EMAIL=contact@tradejaudit.com`
- `MAIL_LOGO_URL=https://tradejaudit.com/branding/tradejaudit-logo-email@2x.png`

### Header behavior
- `From`: set by `JavaMailSenderMailService` from `app.mail.from-*`
- `Reply-To`: set from per-message value; falls back to `app.mail.reply-to-address`
- `Message-ID`: generated by mail infrastructure/provider
- `List-Unsubscribe`: intentionally omitted (transactional flow)

## Preview command
Generate rendered HTML previews with sample data:

```bash
bash backend/scripts/preview-verification-email.sh
```

Outputs:
- `backend/target/mail-preview/verification-en.html`
- `backend/target/mail-preview/verification-ro.html`

## Deliverability (tradejaudit.com)
Configure DNS in your DNS host for `tradejaudit.com`, and configure sender identity in your mail provider admin (current SMTP host indicates Zoho SMTP).

### 1. SPF
- Add/confirm TXT at root (`@`):
  - `v=spf1 include:<provider-spf-domain> ~all`
- Use your provider-generated include domain (for Zoho this is provider/data-center specific).

### 2. DKIM
- Enable DKIM signing in provider admin for `tradejaudit.com`.
- Publish provider DKIM CNAME/TXT selector records in DNS.
- Verify DKIM status shows `enabled`/`passing` in provider dashboard.

### 3. DMARC
- Add TXT record at `_dmarc.tradejaudit.com`:
  - Start: `v=DMARC1; p=none; rua=mailto:dmarc@tradejaudit.com; adkim=s; aspf=s; fo=1`
  - Tighten later: move to `p=quarantine` then `p=reject` after monitoring alignment.

### 4. Optional BIMI
- Only after DMARC enforcement (`p=quarantine` or `p=reject`) with compliant logo/VMC prerequisites.

### 5. Alignment check
- Confirm `no-reply@tradejaudit.com` is a verified sender identity in provider admin.
- Confirm SPF and DKIM both align to `tradejaudit.com`.

## QA checklist
- [x] TradeVault branding removed from verification email flow/template.
- [x] Subject/preheader/footer updated for TradeJAudit.
- [x] `From` and `Reply-To` wiring implemented in backend mail service.
- [x] EN/RO localized verification copy implemented with translation keys.
- [x] Verify link remains templated (`{{verifyUrl}}`) in HTML.
- [x] Expiry copy reflects real TTL (`24h`) from auth flow constant.
- [x] Preview command added and renders EN/RO sample files.
- [x] Template keeps `max-width:600px`, full-width container, and mobile-safe wrapping styles.

## Manual client QA to run
1. Send to Gmail web and Gmail mobile from staging.
2. Verify no horizontal scrolling at 360px width.
3. Verify CTA is visible/clickable and raw URL appears.
4. Verify images-off fallback still shows readable brand header text.
5. Confirm headers in received message source (`From`, `Reply-To`, provider `Message-ID`).
